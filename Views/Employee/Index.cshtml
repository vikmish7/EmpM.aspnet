@model IEnumerable<EmployeeManagementApp.ViewModels.EmployeeDepartmentViewModel>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int i = 1;
    var departments = ViewBag.Departments as List<EmployeeManagementApp.Models.Department>;
    var bloodGroups = new List<string> { "A+", "B+", "AB+", "O+", "A-", "B-", "O-" };
}

<style>
    #loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        color: white;
        font-size: xx-large;
    }
</style>

<div id="loader" >
    <div class="spinner-border text-secondary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
@*<div id="loader">
        <div class="custom-spinner"></div>
    </div>*@


<h2>Employee Information</h2>
<table class="table" id="employeeTable">
    <thead>
        <tr>
            <th>Sr. No</th>
            <th>Employee Name</th>
            <th>Designation</th>
            <th>National ID</th>
            <th>Joining Date</th>
            <th>Code</th>
            <th>Department</th>
            <th>Blood Group</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var employee in Model)
        {
            <tr data-employee-id="@employee.EmployeeId">
                <td>@i</td>
                <td>
                    <span class="view-mode">@employee.EmployeeName</span>
                    <input type="text" class="edit-mode form-control" value="@employee.EmployeeName" style="display:none;" />
                </td>
                <td>
                    <span class="view-mode">@employee.Designation</span>
                    <input type="text" class="edit-mode form-control" value="@employee.Designation" style="display:none;" />
                </td>
                <td>
                    <span class="view-mode">@employee.NID</span>
                    <input type="text" class="edit-mode form-control" value="@employee.NID" style="display:none;" />
                </td>
                <td>
                    <span class="view-mode">@employee.JoiningDate.ToShortDateString()</span>
                    <input type="date" class="edit-mode form-control" value="@employee.JoiningDate.ToString("yyyy-MM-dd")" style="display:none;" />
                </td>
                <td>
                    <span class="view-mode">@employee.Code</span>
                    <input type="text" class="edit-mode form-control" value="@employee.Code" style="display:none;" />
                </td>
                <td>
                    <span class="view-mode">@employee.DepartmentName</span>
                    <select class="edit-mode form-control" style="display:none;">
                        <option value="0">-Select-</option>
                        @foreach (var department in departments)
                        {
                            <option value="@department.DepartmentId" @(department.DepartmentId == employee.DepartmentId ? "selected" : "")>
                                @department.Name
                            </option>
                        }
                    </select>
                </td>
                <td>
                    <span class="view-mode">@employee.BloodGroup</span>
                    <select class="edit-mode form-control" style="display:none;">
                        <option value="0">-Select-</option>
                        @foreach (var group in bloodGroups)
                        {
                            <option value="@group" @(group == employee.BloodGroup ? "selected" : "")>@group</option>
                        }
                    </select>
                </td>
                <td>
                    <button class="btn btn-primary edit-btn">Edit</button>
                    <button class="btn btn-success save-btn" style="display:none;">Save</button>
                    <a href="@Url.Action("Delete", "Employee", new { id = employee.EmployeeId })" class="btn btn-danger delete-btn">Delete</a>
                </td>
            </tr>
            i++;
        }
    </tbody>
</table>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="~/Scripts/Employee.js"></script>

